# 账单汇总分析工具

用于汇总各个支付渠道导出的账单，并汇总成一个账单文件，以及生成数据图

- V1版：仅控制台运行，需要修改config.ini配置，较麻烦
- V2版：增加图形界面版本，可打包成exe，方便日常使用

```
pyinstaller -D -n 账单分析工具 --add-data=./;./ --windowed -p F:\project\bill_analysis\venv\Lib\site-packages -i F:\project\bill_analysis\icon.ico bill_gui.py
```

# 账单分析步骤

```
每月初导入上个月账单
每年初导入去年账单
```

# 一、导出账单

- 账单命名规范

  如果希望导出账单按归属人分类，需要把导出的账单重命名为

  ”xx-wechat账单.csv”

  ”xx-alipay账单.csv”

  ”xx-cmbc账单.csv”

  ”xx-boc账单.csv”

  工具会根据”-”的前面的文字作为归属人名字

## 支付宝

我的 —> 账单 —> 三个点（右上角） —>开具交易流水证明 —> 用于个人对账 —> 筛选 —> 发送电子邮箱 —> 邮箱下载 —> 解压（解压密码为支付宝会员实名认证使用的身份证号码后6位（支持大写字母）） —>
修改为utf-8（可省略）—> 重命名（可省略）

## 微信

我 —> 服务 —> 钱包 —> 账单 —> 常见问题（右上角） —> 下载账单 —> 用于个人对账 —> 筛选 —> 发送电子邮箱 —> 邮箱下载 —> 解压（解压密码通过公众号发放） —> 修改为utf-8（可省略）—>
重命名（可省略）

## 招商银行

登录招商银行PC客户端 —> 一卡通 —> 交易查询 —> 筛选 —> 下载 —> 修改为utf-8（可省略）—> 重命名（可省略）

## 中国银行

**中国银行没有账单导出功能**

登录[中国银行网上银行](https://ebsnew.boc.cn/boc15/welcome_ele.html?v=20220125092828167&locale=zh&login=card&segment=1) —>
银行卡号登录xxxxxxxxxxxxxxxx —> 交易明细 —> 筛选查询 —> 复制内容新建CSV（仅复制数据行，不包含表头） —> 修改为utf-8（可省略）—> 重命名（可省略）

# 二、使用账单分析工具

## 选择导入的账单

分别选择微信、支付宝、招商银行、中国银行的账单

## 选择导出目录

每个月都使用新的目录

## 使用工具

开始分析，等待生成对应账单和图

# 三、导入notion（可选）

1. 打开notion —>import导入账单CSV文件
2. 修改文件名为《20xx年x月账单》，归并到目录 生活规划 → 账本 → 月度账单下
3. 填写 生活规划 → 账本 中的当月数据

# 四、整理账单

把导出账单整理成可读形势，复制工具生成的图到账单

# 五、修改过滤规则

过滤规则暂不支持工具中修改，因修改频率很低，所以直接修改配置文件

过滤规则配置：

```java
列数|操作符|过滤字符串;
```

列数从0开始计数

操作符支持：

=：等于，列数对应的文字完全等于过滤字符串

≠：不等于，列数对应的文字不等于过滤字符串

start：开始于，列数对应的文字以过滤字符串开始

end：结束于，列数对应的文字以过滤字符串结尾

has：包含，列数对应的文字包含过滤字符串

如：

过滤掉招商银行账单的第三列中，内容等于 张三转账，则可在配置文件CMBC的ignore_filters配置为：

2|=|张三|转账

过滤掉中国银行账单的第一列中，内容包含李四发红包，则可在配置文件BOC的ignore_filters配置为：

0|has|李四发红包

如果同一个渠道中有多个过滤条件，则用分号”;”进行拼接